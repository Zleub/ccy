<dom-module id="monitor-doc">
	<template>
	<style>
		:host {
			display: block;
		}
	</style>

	<iron-ajax
		auto
		url="/client/doc.md"
		handle-as="text"
		last-response="{{response}}">
	</iron-ajax>

	<!-- <marked-element markdown='```{{response}}```'></marked-element> -->

	</template>
	<script>
		Polymer({
			is: 'monitor-doc',
			properties: {
				response: {
					type: String,
					observer: 'doc'
				}
			},

			doc: function (s) {
				s.split('\n\n').filter(e => e != '').forEach( s => {
					if (s.match(/(.+)->/) == null)
						return

					let _ = document.createElement('div')

					let b = document.createElement('paper-button')
					b.raised = true

					b.innerText = s.match(/(.+)->/)[1]
					let d = document.createElement('iron-collapse')

					b.addEventListener('tap', () => d.toggle())
					let m = document.createElement('marked-element')
					m.markdown = '```\n' + s + '```'
					d.appendChild(m)

					_.appendChild(b)
					_.appendChild(d)

					this.appendChild(_)
				})
			}
		});
	</script>
</dom-module>
